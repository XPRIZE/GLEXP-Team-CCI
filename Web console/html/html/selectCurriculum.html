<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Curriculum Creator</title>
  <link rel="styleSheet" href="../css/webixPersonalModifications.css" />
  <link rel="stylesheet" href="includes/webix/webix.css"/>
  <script src="includes/jquery.js"></script>
  <script src="includes/webix/webix_debug.js"></script>
  <script src="includes/dropzone.js"></script>
  <link rel="stylesheet" href="includes/dropzone.css"></link>
</head>
<body>
</body>
<script>
  var header = {
    view: "toolbar",
    height: 55,
    autoWidth: true,
    cols: [
      {
        view: "button", value: "Home", width: 80, on: {
        onItemClick: function () {
          window.location.href = "index.php";
        }
      }
      },
      {
        view: "label",
        template: "<p class='toolbarCenterLabel'>Curriculum Creator</p>"
      },
      {
        view: "button", value: "Logout", width: 80, on: {
        onItemClick: function () {
          window.location.href = "logout.php";
        }
      }
      }
    ]
  };
  window.newCurriculumTimeout = false;
  var elem = {
    view: "scrollview",
    width: "100%",
    body: {
      type: "space",
      rows: [
        header,
        {
          view: "tabview",
          id: "editAndCreateTab",
          cells: [
            {
              id: "editTab",
              header: "Edit Curriculum",
              cols: [
                {
                  header: "Curriculums", body: {
                  autoheight: true, select: "multiselect", view: "list", template: "#name#: #length# children", data: [
                    {ID: 1, length: 5, name: "Xprize swahili", children: []},
                    {ID: 2, length: 2, name: "Xprize english", children: []},
                    {ID: 3, length: 9, name: "Penguin something mumble", children: []},
                    {ID: 4, length: 1, name: "mumble bumble mumbum", children: []},
                  ]
                }
                }
                // curriculumList goes here,
                // curriculumActions goes here
              ]
            },
            {
              id: "createTab",
              header: "New Curriculum",
              cols: [
                {gravity: 1},
                {
                  gravity: 5,
                  maxWidth: 400,
                  autoheight: true,
                  rows: [
                    {height: 10,},
                    {
                      header: "Step 1", collapsed: false, body: {
                      view: "form",
                      gravity: 1,
                      elements: [
                        {
                          view: "text", label: "Name Curriculum: ", id: "newCurriculumName", labelWidth: 150, on: {
                          onTimedKeyPress: function () {
                            var requestName = $$("newCurriculumName").getValue();
                            if (requestName) {
                              if (newCurriculumTimeout) {
                                window.clearTimeout(newCurriculumTimeout);
                              }
                              $$("newCurriculum").disable();
                              $$("newCurriculum").setValue("Checking...");
                              $$("newCurriculum").refresh();
                              window.newCurriculumTimeout = window.setTimeout(function () {
                                var jqxhr = $.ajax("ajax/check/checkCurriculumName.php?name=" + requestName)
                                    .done(function (ret) {
                                      if (ret == "") {
                                        $$("newCurriculum").enable();
                                        $$("newCurriculum").setValue("Create new curriculum");
                                        $$("newCurriculum").refresh()
                                      } else {
                                        $$("newCurriculum").disable();
                                        $$("newCurriculum").setValue("Name taken");
                                        $$("newCurriculum").refresh();
                                      }
                                    })
                                    .fail(function () {
                                      alert("error");
                                    })
                              }, 500);
                            } else {
                              $$("newCurriculum").disable();
                              $$("newCurriculum").setValue("Enter a name");
                              $$("newCurriculum").refresh();
                            }
                          }
                        }
                        },
                        {
                          view: "button", id: "newCurriculum", value: "Enter a name", disabled: true, on: {
                          onItemClick: function () {
                            $$("newCurriculumName").disable();
                            $$(this).disable();
                            $$(this).setValue("Please wait...");
                            $$(this).refresh();
                            var requestName = $$("newCurriculumName").getValue();
                            if (requestName) {
                              // Check one last time, just to be safe and stuff and things and
                              $.ajax("ajax/check/checkCurriculumName.php?name=" + requestName).done(function (ret) {
                                if (ret == "") {
                                  $.ajax("ajax/new/newCurriculum.php?name=" + requestName).done(function (ret) {
                                    if (ret == "true" || ret == 1) {
                                      window.location.href = window.location.href;
                                    } else {
                                      document.body = ret;
                                    }
                                  });
                                } else {
                                  $$("newCurriculum").disable();
                                  $$("newCurriculum").setValue("Name taken");
                                  $$("newCurriculum").refresh();
                                  $$("newCurriculumName").enable();
                                }
                              });
                            } else {
                              $$(this).enable();
                              $$(this).setValue("Enter a name");
                              $$("newCurriculumName").enable();
                            }
                          }
                        }
                        },
                      ]
                    },
                    },
                    {height: 10,},
                  ]
                },
                {gravity: 1},
              ],
            },
          ]
        }
      ]
    }
  };
  webix.ui(elem);

</script>
</html>




















